/*!CK:433407504!*//*1441681614,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["+SsIq"]); }

__d('UFIReactionIcon.react',['React','UFIReactionTypes','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m,n=h.PropTypes;l=babelHelpers.inherits(o,h.Component);m=l&&l.prototype;function o(p,q){'use strict';m.constructor.call(this);}o.prototype.render=function(){'use strict';var p=k("_2d1t"+(this.props.size==='tiny'?' '+"_2d1w":'')+(this.props.size==='16'?' '+"_1fxb":'')+(this.props.size==='48'?' '+"_k43":''),i.reactions[this.props.reaction].name,this.props.className);return h.createElement('i',{className:p});};o.propTypes={className:n.string,reaction:n.number.isRequired,size:n.oneOf(['tiny','16','48'])};o.defaultProps={className:null,size:'16'};f.exports=o;},null);
__d('UFIReactionsDialogLayer.react',['AccessibleLayer','BrowserSupport','ContextualDialog','ContextualDialogArrow','ContextualLayerAutoFlip','CSS','LayerRefocusOnHide','ReactLayer','ReactTransitionEvents','SubscriptionsHandler','cx','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t="_2r6j",u="_2r6k",v=i.hasCSSAnimations();function w(y){'use strict';this.layer=y;this.onHideEnd=this.onHideEnd.bind(this);this.onShowEnd=this.onShowEnd.bind(this);this.handler=new q();}w.prototype.onHideEnd=function(){'use strict';var y=this.layer.getContentRoot();p.removeEndEventListener(y,this.onHideEnd);s((function(){m.removeClass(y,u);this.layer.finishHide();}).bind(this));};w.prototype.onShowEnd=function(){'use strict';var y=this.layer.getContentRoot();p.removeEndEventListener(y,this.onShowEnd);s(function(){m.removeClass(y,t);});};w.prototype.enable=function(){'use strict';var y=this.layer.getContentRoot();this.handler.addSubscriptions(this.layer.subscribe('beforeshow',(function(){p.addEndEventListener(y,this.onShowEnd);m.addClass(y,t);}).bind(this)),this.layer.subscribe('starthide',(function(){p.addEndEventListener(y,this.onHideEnd);m.addClass(y,u);return false;}).bind(this)));};w.prototype.disable=function(){'use strict';this.handler.release();var y=this.layer.getContentRoot();p.removeEndEventListener(y,this.onHideEnd);p.removeEndEventListener(y,this.onShowEnd);};var x=o.createClass({createLayer:function(y){var z=new j({addedBehaviors:this.enumerateBehaviors({ContextualLayerAutoFlip:l,UFIReactionsDialogLayerTransition:v?w:null}),context:this.props.context,displayName:'UFIReactionsDialog',position:'above',shouldSetARIAProperties:false,theme:{wrapperClassName:"_2r6l"}},y);z.disableBehavior(h);z.disableBehavior(k);z.disableBehavior(n);z.conditionShow(this.props.shown);var aa=new q();aa.addSubscriptions(z.subscribe('mouseenter',this.props.onMouseEnter),z.subscribe('mouseleave',this.props.onMouseLeave),z.subscribe('destroy',function(){aa.release();}));return z;},receiveProps:function(y,z){this.layer.conditionShow(y.shown);}});f.exports=x;},null);
__d('UFIReactionsMenu.react',['React','UFIReactionsDialogLayer.react','UFIReactionIcon.react','UFIReactionTypes','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,h.Component);n=m&&m.prototype;function o(p,q){'use strict';n.constructor.call(this);this.state={};}o.prototype.onBlur=function(event){'use strict';this.props.onBlur&&this.props.onBlur(event);};o.prototype.onClick=function(p,event){'use strict';event.preventDefault();this.props.onClick&&this.props.onClick(p,event);};o.prototype.render=function(){'use strict';var p=k.ordering.map((function(q){if(!k.reactions[q])return null;q=parseInt(q+'',10);return (h.createElement('a',{className:"_iuw",href:'#',key:'reaction_'+q,onBlur:this.onBlur.bind(this),onClick:this.onClick.bind(this,q),onMouseEnter:this.props.onReactionMouseEnter.bind(this,q),onMouseLeave:this.props.onReactionMouseLeave.bind(this,q),onMouseUp:this.props.onReactionMouseUp.bind(this,q),role:'button'},h.createElement('div',{className:"_d6k"},h.createElement(j,{className:"_iuz",reaction:q,size:'48'}),h.createElement('div',{className:"_d6l"},h.createElement('div',{className:"_4sm1"},k.reactions[q].display_name)))));}).bind(this)).filter(function(q){return q;});return (h.createElement(i,{context:this.props.context,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,shown:this.props.shown},h.createElement('div',{className:"_iu-"},p)));};f.exports=o;},null);
__d('UFIReactionsLink.react',['AsyncRequest','BanzaiLogger','Event','InlineBlock.react','React','ReactDOM','ReactLayeredComponentMixin','UFIConstants','UFIReactionIcon.react','UFIReactionsMenu.react','UFIReactionTypes','UFIUserActions','XFeedNUXSaveSeenStateController','XUIAmbientNUX.react','XUIText.react','classWithMixins','cx','fbt','getActiveElement','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba,ca,da,ea,fa=false,ga=true,ha=r.reactions,ia=500,ja=250;ba=babelHelpers.inherits(ka,w(l.Component,aa(n)));ca=ba&&ba.prototype;function ka(la,ma){'use strict';ca.constructor.call(this);this.hideDialog=this.hideDialog.bind(this);this.showDialog=this.showDialog.bind(this);this.$UFIReactionsLink1();this.state={dialogShown:false,reaction:la.reaction,NUXShown:false};fa=la.hasReactionsNUX;if(!da&&!ea){da=j.listen(window,'blur',(function(){this.focusHandlerLock=true;ga=false;}).bind(this));ea=j.listen(window,'focus',(function(){ga=true;if(z()!==m.findDOMNode(this.refs.trigger))this.focusHandlerLock=false;}).bind(this));}}ka.prototype.componentWillReceiveProps=function(la){'use strict';this.setState({reaction:la.reaction});};ka.prototype.renderLayers=function(){'use strict';return {ufiReactionsPopover:l.createElement(q,{context:m.findDOMNode(this.refs.root),onBlur:this.onBlur.bind(this),onClick:this.onReactionChange.bind(this),onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this),onReactionMouseEnter:this.onReactionMouseEnter.bind(this),onReactionMouseLeave:this.onReactionMouseLeave.bind(this),onReactionMouseUp:this.onReactionMouseUp.bind(this),selected:this.state.reaction,shown:this.state.dialogShown}),nux:l.createElement(u,{hasActionableContext:true,context:m.findDOMNode(this.refs.root),onCloseButtonClick:this.hideNux.bind(this),shown:this.state.NUXShown&&!this.state.dialogShown},l.createElement('div',null,l.createElement(v,{display:'block',weight:'bold'},y._("New! React to a Post")),l.createElement(v,{display:'block'},y._("Hover over the Like button to love, wow, yay and more..."))))};};ka.prototype.maybeShowNUX=function(){'use strict';if(fa){fa=false;this.setState({NUXShown:true});i.log('WebReactionsNuxLoggerConfig',{feedback_id:this.props.id,'interface':'www'});var la=t.getURIBuilder().setString('key','reactions').setBool('seen',true);new h(la.getURI()).setMethod('POST').send();}};ka.prototype.hideNux=function(){'use strict';this.setState({NUXShown:false});};ka.prototype.hideDialog=function(){'use strict';this.$UFIReactionsLink2(this.state.reaction);clearTimeout(this.hoverTimeout);this.setState({dialogShown:false});};ka.prototype.showDialog=function(){'use strict';if(this.dialogShownTime===0)this.dialogShownTime=Date.now();fa=false;clearTimeout(this.hoverTimeout);this.setState({dialogShown:true,NUXShown:false});};ka.prototype.onReactionChange=function(la,event){'use strict';this.$UFIReactionsLink2(la);s.changeReaction(this.props.id,la,{target:event.target});this.hideDialog();};ka.prototype.onBlur=function(event){'use strict';if(!m.findDOMNode(this.refs.root).contains(z())&&!m.findDOMNode(this.refs.root).contains(event.relatedTarget))this.hideDialog();};ka.prototype.onDragStart=function(event){'use strict';this.setIsScrubbing(true);event.preventDefault();};ka.prototype.onMouseDown=function(event){'use strict';this.setFocusHandlerLock(true);this.setIsScrubbing(false);};ka.prototype.onMouseEnter=function(event){'use strict';if(!ga)return;clearTimeout(this.hoverTimeout);this.hoverTimeout=setTimeout(this.showDialog,ia);};ka.prototype.onMouseLeave=function(event){'use strict';if(!ga)return;clearTimeout(this.hoverTimeout);this.hoverTimeout=setTimeout(this.hideDialog,ja);};ka.prototype.onReactionMouseEnter=function(la,event){'use strict';if(this.reactionsHoverStartTimeMap[la]===0)this.reactionsHoverStartTimeMap[la]=Date.now();};ka.prototype.onReactionMouseLeave=function(la,event){'use strict';if(this.reactionsHoverStartTimeMap[la]){this.reactionsHoverTotalTimeMap[la]+=Date.now()-this.reactionsHoverStartTimeMap[la];this.reactionsHoverStartTimeMap[la]=0;}};ka.prototype.onReactionMouseUp=function(la,event){'use strict';if(this.isScrubbing){this.onReactionChange(la,event);this.setIsScrubbing(false);}};ka.prototype.onFocus=function(event){'use strict';if(!this.focusHandlerLock)this.showDialog();this.focusHandlerLock=false;};ka.prototype.setFocusHandlerLock=function(la){'use strict';this.focusHandlerLock=la;};ka.prototype.setIsScrubbing=function(la){'use strict';this.isScrubbing=la;};ka.prototype.renderTrigger=function(){'use strict';var la={onBlur:this.onBlur.bind(this),onDragStart:this.onDragStart.bind(this),onFocus:this.onFocus.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.setFocusHandlerLock.bind(this,false),onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this),ref:'trigger'};if(!this.state.reaction||this.state.reaction===o.LikeReaction||!ha[this.state.reaction]){var ma=l.Children.only(this.props.children);return l.cloneElement(ma,Object.assign(babelHelpers._extends({onClick:(function(event){this.hideDialog();this.maybeShowNUX();ma.props.onClick(event);}).bind(this)},la)));}return (l.createElement('a',babelHelpers._extends({className:"UFILikeLink UFILinkBright",href:'#',onClick:this.onReactionChange.bind(this,0)},la),l.createElement(p,{className:"_1ktw",reaction:this.state.reaction,size:'tiny'}),ha[this.state.reaction].display_name));};ka.prototype.render=function(){'use strict';return (l.createElement(k,{className:'uiContextualLayerParent',ref:'root'},this.renderTrigger()));};ka.prototype.$UFIReactionsLink1=function(){'use strict';this.dialogShownTime=0;this.reactionsHoverStartTimeMap={};this.reactionsHoverTotalTimeMap={};r.ordering.forEach((function(la){this.reactionsHoverStartTimeMap[la]=0;this.reactionsHoverTotalTimeMap[la]=0;}).bind(this));};ka.prototype.$UFIReactionsLink2=function(la){'use strict';if(this.dialogShownTime!==0){var ma=babelHelpers._extends({feedback_id:this.props.id,final_reaction:la,initial_reaction:this.state.reaction,'interface':'www',time_spent:Date.now()-this.dialogShownTime},{});for(var na in this.reactionsHoverTotalTimeMap){var oa='time_spent_'+ha[na].name.toLowerCase();ma[oa]=this.reactionsHoverTotalTimeMap[na];}i.log('UserReactionsLoggerConfig',ma);this.$UFIReactionsLink1();}};f.exports=ka;},null);
__d('UFIReactionsTooltip.react',['ActorURI','AsyncRequest','DataStore','DOM','React','ReactDOM','Tooltip','UFIReactionTypes','URI','XUFIReactionTooltipController','cx','emptyFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u,v,w=l.PropTypes,x=/(\r\n|[\r\n])/;u=babelHelpers.inherits(y,l.Component);v=u&&u.prototype;function y(z,aa){'use strict';v.constructor.call(this);this.$UFIReactionsTooltip1=null;this.state={container:k.create('div'),count:z.feedback.reactioncountmap[z.reaction]['default'],onMouseEnter:this.onMouseEnter.bind(this)};}y.prototype.componentDidMount=function(){'use strict';this.renderTooltip();};y.prototype.componentWillReceiveProps=function(z){'use strict';var aa=z.feedback.reactioncountmap[z.reaction]['default'];if(aa!==this.state.count){this.$UFIReactionsTooltip1&&this.$UFIReactionsTooltip1.abort();this.$UFIReactionsTooltip1=null;var ba=n.isActive(m.findDOMNode(this));this.renderTooltip();this.setState({count:aa,onMouseEnter:ba?null:this.onMouseEnter.bind(this)});if(ba)this.loadTooltip();}};y.prototype.componentWillUnmount=function(){'use strict';this.$UFIReactionsTooltip1&&this.$UFIReactionsTooltip1.abort();this.$UFIReactionsTooltip1=null;};y.prototype.onMouseEnter=function(){'use strict';this.setState({onMouseEnter:s});this.loadTooltip();};y.prototype.loadTooltip=function(){'use strict';var z=h.create(q.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).setEnum('reaction_type',this.props.reaction).setInt('user_count',this.props.feedback.reactioncountmap[this.props.reaction]['default']).getURI(),this.props.feedback.actorforpost);this.$UFIReactionsTooltip1=new i(z).setHandler((function(aa){this.$UFIReactionsTooltip1=null;this.renderTooltip(aa.getPayload());}).bind(this)).setErrorHandler(s);this.$UFIReactionsTooltip1.send();};y.prototype.renderTooltip=function(z){'use strict';var aa;if(z!==undefined&&z!==null){aa=z.split(x).filter(function(da){return da!=='';}).map(function(da,ea){return x.test(da)?l.createElement('br',{key:ea}):da;});}else aa=t._("Loading...");var ba=l.createElement('div',null,l.createElement('div',{className:"_262g"},o.reactions[this.props.reaction].display_name),aa),ca=m.findDOMNode(this);j.set(ca,'tooltip',{alignH:'left',content:m.render(ba,this.state.container),overflowDisplay:false,position:'above',suppress:false});n.isActive(ca)&&n.show(ca);};y.prototype.render=function(){'use strict';return (l.createElement('a',babelHelpers._extends({'data-hover':'tooltip',onFocus:this.state.onMouseEnter,onMouseEnter:this.state.onMouseEnter},this.props),this.props.children));};y.propTypes={feedback:w.object.isRequired,reaction:w.number.isRequired};f.exports=y;},null);
__d('UFIReactionsTokens.react',['ActorURI','ProfileBrowserLink','ProfileBrowserTypes','React','Image.react','UFIConstants','UFIReactionIcon.react','UFIReactionsTooltip.react','UFIReactionTypes','URI','XUFICommentTooltipController','XUFIReactionProfileBrowserController','XUFIReactionProfileDialogController','XUFIShareTooltipController','cx','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y,z;y=babelHelpers.inherits(aa,k.Component);z=y&&y.prototype;function aa(ba,ca){'use strict';z.constructor.call(this);this.state={hidden:{}};}aa.prototype.componentDidMount=function(){'use strict';this.componentDidMountOrUpdate();};aa.prototype.componentDidUpdate=function(){'use strict';this.componentDidMountOrUpdate();};aa.prototype.componentWillReceiveProps=function(ba){'use strict';if(ba.feedback.reactioncount!==this.props.feedback.reactioncount)this.setState({hidden:{}});};aa.prototype.componentDidMountOrUpdate=function(){'use strict';var ba,ca;if(this.refs.tokens.scrollWidth>this.refs.root.offsetWidth)for(var da=p.ordering.length;da>0;da--){ba=p.ordering[da-1];ca=this.refs['token-'+ba];if(ca&&!this.state.hidden[ba]){var ea=Object.create(this.state.hidden);ea[ba]=true;this.setState({hidden:ea});break;}}};aa.prototype.getDialogURI=function(ba){'use strict';var ca=t.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier);if(ba)ca.setEnum('reaction_type',ba);return h.create(ca.getURI(),this.props.feedback.actorforpost);};aa.prototype.getPageURI=function(){'use strict';return h.create(s.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI(),this.props.feedback.actorforpost);};aa.prototype.renderEllipsis=function(){'use strict';if(!Object.keys(this.state.hidden).length)return null;return (k.createElement('a',{ajaxify:this.getDialogURI(),'aria-label':w._("See who reacted to this"),className:"_3_vg _3emk _3t52",href:this.getPageURI(),rel:'dialog'},k.createElement(l,{className:"_4-op",height:'16',src:x('images/ufi/reactions/16x16/ellipsis.png'),width:'16'})));};aa.prototype.renderComments=function(){'use strict';if(!this.props.commentCount||this.props.contextArgs.feedbackMode==='expanded')return null;var ba=isNaN(this.props.feedback.commentcountreduced)?this.props.feedback.commentcountreduced:this.props.commentCount,ca=w._({"Comment":"{count} Comment","Comments":"{count} Comments"},[w.param('count',ba),w['enum'](this.props.commentCount===1?'Comment':'Comments',{Comment:'Comment',Comments:'Comments'})]),da=h.create(r.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI(),this.props.feedback.actorforpost);return (k.createElement('a',{'aria-label':ca,'aria-live':'polite',className:"_3_vg _3emk _3emm",'data-comment-prelude-ref':this.props['data-comment-prelude-ref'],'data-ft':this.props['data-ft'],'data-hover':'tooltip','data-tooltip-uri':da,href:this.props.permalink,onClick:this.props.onCommentClick,rel:'ignore'},k.createElement(l,{className:"_4-op",src:x('/images/ufi/reactions/16x16/comment.png')}),ba));};aa.prototype.renderSeens=function(){'use strict';var ba=this.props.feedback.seencount;if(ba===0||this.props.contextArgs.entstream)return null;var ca=j.GROUP_MESSAGE_VIEWERS,da={id:this.props.feedback.targetfbid},ea=new q('/ajax/ufi/seen_tooltip.php').setQueryData({ft_ent_identifier:this.props.feedback.entidentifier,displayed_count:ba}),fa;if(this.props.feedback.seenbyall){fa=w._("Seen by everyone");}else if(ba===1){fa=w._("Seen by 1");}else fa=w._("Seen by {count}",[w.param('count',ba)]);return (k.createElement('a',{ajaxify:i.constructDialogURI(ca,da),'aria-live':'polite',className:"_3_vg",'data-hover':'tooltip','data-tooltip-uri':ea,href:i.constructPageURI(ca,da),rel:'dialog'},fa));};aa.prototype.renderShares=function(){'use strict';if(!this.props.feedback.sharecount)return null;var ba=new q('/ajax/shares/view').setQueryData({target_fbid:this.props.feedback.targetfbid});ba=h.create(ba,this.props.feedback.actorforpost);var ca=new q('/shares/view').setSubdomain('www').setQueryData({id:this.props.feedback.targetfbid});ca=h.create(ca,this.props.feedback.actorforpost);var da=h.create(u.getURIBuilder().setString('ft_ent_identifier',this.props.feedback.entidentifier).getURI(),this.props.feedback.actorforpost),ea=w._({"Share":"{count} Share","Shares":"{count} Shares"},[w.param('count',this.props.feedback.sharecountreduced),w['enum'](this.props.feedback.sharecount===1?'Share':'Shares',{Share:'Share',Shares:'Shares'})]);return (k.createElement('a',{ajaxify:ba,'aria-label':ea,'aria-live':'polite',className:"_3_vg _3emk _3emn",'data-hover':'tooltip','data-tooltip-uri':da,href:ca,rel:'dialog'},k.createElement(l,{className:"_4-op",src:x('/images/ufi/reactions/16x16/share.png')}),this.props.feedback.sharecountreduced));};aa.prototype.renderTokens=function(){'use strict';var ba=p.ordering.map((function(ca){if(this.state.hidden[ca]||!p.reactions[ca]||!this.props.feedback.reactioncountmap[ca]['default'])return null;return this.renderToken(ca);}).bind(this));return ba;};aa.prototype.renderToken=function(ba){'use strict';var ca=p.reactions[ba].display_name;return (k.createElement(o,{ajaxify:this.getDialogURI(ba),'aria-label':ca,'aria-live':'polite',className:"_3_vg _3emk",feedback:this.props.feedback,href:this.getPageURI(),key:'reactionType-'+ba,ref:'token-'+ba,reaction:ba,rel:'dialog'},k.createElement(n,{className:"_4-op",reaction:ba}),this.props.feedback.reactioncountmap[ba].reduced));};aa.prototype.renderViews=function(){'use strict';var ba=this.props.contextArgs.viewCount;if(!ba)return null;return (k.createElement('span',{'aria-live':'polite',className:"_3_vg"},w._({"View":"{count} View","Views":"{count} Views"},[w.param('count',this.props.contextArgs.viewCountReduced),w['enum'](this.props.feedback.sharecount===1?'View':'Views',{View:'View',Views:'Views'})])));};aa.prototype.render=function(){'use strict';return (k.createElement('div',{className:"_3t53",ref:'root'},k.createElement('div',{className:"_3t54",ref:'tokens'},this.renderTokens(),this.renderEllipsis(),this.renderComments(),this.renderShares(),k.createElement('div',{className:"_3_vi"},this.renderSeens(),this.renderViews()))));};f.exports=aa;},null);